---
phase: 05-retention-cleanup
plan: 01
type: execute
wave: 1
depends_on: []
files_modified:
  - src/types.ts
autonomous: true
user_setup: []

must_haves:
  truths:
    - "RotationConfig interface includes maxFiles and maxAge fields"
    - "Both fields are optional (not required for rotation)"
    - "Fields documented with default values and usage requirements"
  artifacts:
    - path: "src/types.ts"
      provides: "RotationConfig interface with retention fields"
      contains: "maxFiles, maxAge"
  key_links:
    - from: "src/types.ts"
      to: "FileTransport constructor"
      via: "RotationConfig interface"
      pattern: "maxFiles|maxAge"
---

<objective>
Add retention configuration fields to RotationConfig interface to support automatic cleanup of old log files.

Purpose: Enable users to configure retention policy (maxFiles + maxAge) for automatic log file cleanup.
Output: Extended RotationConfig interface with maxFiles and maxAge fields.
</objective>

<execution_context>
@~/.claude/get-shit-done/workflows/execute-plan.md
@~/.claude/get-shit-done/templates/summary.md
</execution_context>

<context>
@.planning/STATE.md
@.planning/phases/05-retention-cleanup/05-CONTEXT.md
@.planning/phases/05-retention-cleanup/05-RESEARCH.md
@src/types.ts
</context>

<tasks>

<task type="auto">
  <name>Task 1: Extend RotationConfig with maxFiles and maxAge fields</name>
  <files>src/types.ts</files>
  <action>
    Extend the RotationConfig interface in src/types.ts to add retention configuration fields:

    Add these two optional fields after compressionLevel:
    - maxFiles?: number - Maximum number of log files to keep (default: 20)
    - maxAge?: number - Maximum age of log files in days (default: 30)

    JSDoc requirements:
    - Explain that BOTH maxFiles AND maxAge must be specified together
    - Document default values (maxFiles: 20, maxAge: 30)
    - Explain retention policy: file deleted only if BOTH conditions met (too many files AND too old)
    - Note that maxFiles counts total files (including current active file)
    - Clarify that this is optional - rotation works without retention

    Follow existing documentation style in RotationConfig interface (similar to compressionLevel documentation).
  </action>
  <verify>
    grep -A 20 "export interface RotationConfig" src/types.ts | grep -E "maxFiles|maxAge"
  </verify>
  <done>
    RotationConfig interface includes maxFiles and maxAge fields with:
    - Clear documentation that both must be specified together
    - Default values documented (maxFiles: 20, maxAge: 30)
    - Retention policy explained (AND logic)
    - Fields are optional (rotation works without retention)
  </done>
</task>

</tasks>

<verification>
- RotationConfig interface compiles without TypeScript errors
- maxFiles and maxAge fields are present and documented
- JSDoc explains both-fields-required requirement
- Default values are documented
- Retention policy (AND logic) is explained
</verification>

<success_criteria>
RotationConfig interface extended with retention fields
Users can configure retention policy (maxFiles + maxAge) in future plans
Interface is ready for FileTransport integration in next plan
</success_criteria>

<output>
After completion, create `.planning/phases/05-retention-cleanup/05-01-SUMMARY.md`
</output>
