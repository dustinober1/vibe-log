---
phase: 03-time-based-rotation
plan: 05
type: execute
wave: 5
depends_on: [03-04]
files_modified:
  - README.md
autonomous: true
user_setup: []

must_haves:
  truths:
    - "README documents time-based rotation configuration with examples"
    - "Users understand how to configure daily rotation pattern"
    - "Hybrid rotation (size + time) is documented with examples"
    - "UTC midnight behavior is clearly explained"
    - "Timer cleanup and memory management are documented"
  artifacts:
    - path: "README.md"
      provides: "Documentation for time-based rotation"
      contains: "Time-based rotation section"
      contains: "pattern: 'daily' examples"
      contains: "Hybrid rotation examples"
  key_links:
    - from: "README.md rotation section"
      to: "RotationConfig type"
      via: "type reference"
      pattern: "RotationConfig.*pattern"
---

<objective>
Document time-based rotation feature in README with configuration examples and usage guidelines.

Purpose: Complete user-facing documentation for time-based rotation feature. Explain daily rotation pattern configuration, hybrid rotation (size + time), UTC midnight behavior, and timer cleanup. Provide clear examples for common use cases. Ensure documentation is comprehensive and easy to understand.

Output: Updated README.md with time-based rotation section, configuration examples, and usage guidelines.
</objective>

<execution_context>
@~/.claude/get-shit-done/workflows/execute-plan.md
@~/.claude/get-shit-done/templates/summary.md
</execution_context>

<context>
@.planning/STATE.md
@.planning/ROADMAP.md
@.planning/REQUIREMENTS.md
@.planning/phases/03-time-based-rotation/03-01-SUMMARY.md
@.planning/phases/03-time-based-rotation/03-02-SUMMARY.md
@.planning/phases/03-time-based-rotation/03-03-SUMMARY.md
@.planning/phases/03-time-based-rotation/03-04-SUMMARY.md

@README.md
@src/types.ts
</context>

<tasks>

<task type="auto">
  <name>Task 1: Add Time-based Rotation section to README</name>
  <files>README.md</files>
  <action>
    Add new section to README.md documenting time-based rotation:

    Section structure (place after existing rotation documentation):

    ```markdown
    ### Time-based Rotation

    **Daily rotation at midnight UTC** for organized log management.

    #### Basic Daily Rotation

    \`\`\`typescript
    import { configure } from '@log-vibe/node';

    configure({
        file: './logs/app.log',
        rotation: {
            pattern: 'daily'
        }
    });
    \`\`\`

    This creates a new log file every day at midnight UTC:
    - `app.log` (current day)
    - `app-2026-01-17.log.1` (yesterday)
    - `app-2026-01-16.log.1` (two days ago)
    - ...and so on

    #### Hybrid Rotation (Size + Time)

    Combine daily rotation with size limits for comprehensive log management:

    \`\`\`typescript
    configure({
        file: './logs/app.log',
        rotation: {
            pattern: 'daily',    // Rotate at midnight
            maxSize: '100MB'     // Also rotate if file exceeds 100MB
        }
    });
    \`\`\`

    This ensures logs rotate:
    - Every day at midnight UTC
    - Whenever the file exceeds 100MB (whichever happens first)

    #### How It Works

    **UTC Midnight:**
    - Rotation occurs at midnight UTC (not local time)
    - This avoids Daylight Saving Time (DST) issues
    - Ensures consistent rotation across servers in different timezones

    **Automatic Scheduling:**
    - Timer is automatically scheduled when `pattern: 'daily'` is configured
    - Timer reschedules itself recursively for accurate daily rotation
    - No manual intervention required

    **Timer Cleanup:**
    - Timers are automatically cleared when logger is closed
    - Call `await closeLogger()` during application shutdown
    - Prevents memory leaks from uncleared timers

    #### Configuration Reference

    | Option | Type | Default | Description |
    |--------|------|---------|-------------|
    | `pattern` | `'daily'` | `undefined` | Enable daily rotation at midnight UTC |
    | `maxSize` | `string \| number` | `'100MB'` | Size threshold for rotation |

    #### Examples

    **Application logs with daily rotation:**
    \`\`\`typescript
    import { configure, info } from '@log-vibe/node';

    configure({
        file: './logs/app.log',
        rotation: { pattern: 'daily' }
    });

    info('Application started');
    // Logs to ./logs/app.log
    // At midnight UTC, rotates to ./logs/app-YYYY-MM-DD.log.1
    \`\`\`

    **High-traffic logs with hybrid rotation:**
    \`\`\`typescript
    configure({
        file: './logs/api.log',
        rotation: {
            pattern: 'daily',
            maxSize: '50MB'  // Rotate if file gets too large
        }
    });
    \`\`\`

    **Disable rotation (default):**
    \`\`\`typescript
    configure({
        file: './logs/app.log'
        // No rotation config = no rotation
    });
    \`\`\`
    ```

    Integration notes:
    - Place this section after "Size-based Rotation" section
    - Before "Compression" section (placeholder for Phase 4)
    - Update rotation overview table to include pattern option
    - Add cross-reference between size-based and time-based rotation sections

    Research reference: 03-RESEARCH.md (UTC rationale, timer behavior)
  </action>
  <verify>
    grep -n "Time-based Rotation" README.md returns section header
    grep -n "pattern.*daily" README.md returns examples
    grep -n "UTC midnight" README.md returns explanation
  </verify>
  <done>
    Time-based rotation documented in README with configuration examples
  </done>
</task>

<task type="auto">
  <name>Task 2: Update rotation overview and reference table</name>
  <files>README.md</files>
  <action>
    Update existing rotation documentation sections:

    1. Update rotation overview section (near beginning of rotation docs):
       - Add mention of time-based rotation alongside size-based rotation
       - Explain that both strategies can be combined (hybrid)

    2. Update RotationConfig reference table:
       - Add row for `pattern` field
       - Update table to show both maxSize and pattern options

    3. Add cross-references:
       - In size-based rotation section, add "See also: Time-based Rotation"
       - In time-based rotation section, add "See also: Size-based Rotation"
       - Link to hybrid rotation examples in both sections

    4. Update "Migration from basic file logging" section:
       - Add example showing time-based rotation migration
       - Show both size-only and time-only migration paths

    Ensure documentation flows logically and is easy to navigate.
  </action>
  <verify>
    grep -A 10 "RotationConfig" README.md | grep -q "pattern"
    grep -n "hybrid rotation" README.md returns mentions
  </verify>
  <done>
    Rotation overview updated with time-based rotation information
  </done>
</task>

</tasks>

<verification>
1. README.md has Time-based Rotation section with clear examples
2. Pattern configuration is documented with use cases
3. Hybrid rotation (size + time) is explained
4. UTC midnight behavior is clearly documented
5. Timer cleanup and memory management are mentioned
6. Cross-references link related sections
7. Documentation is consistent with existing style
</verification>

<success_criteria>
1. Users can understand how to configure daily rotation from README
2. Examples cover common use cases (daily only, hybrid, no rotation)
3. UTC behavior is clearly explained to avoid confusion
4. Documentation maintains consistency with existing rotation docs
5. All configuration options are documented
</success_criteria>

<output>
After completion, create `.planning/phases/03-time-based-rotation/03-05-SUMMARY.md`
</output>
